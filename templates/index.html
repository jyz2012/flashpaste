{% extends "base.html" %}

{% block title %}FlashPaste 在线剪贴板{% endblock %}

{% block extra_css %}
    <link id="highlight-theme-default" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <link id="highlight-theme-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css" disabled>
    <!--您可以添加更多主题，并默认设置为 disabled -->
{% endblock %}

{% block extra_js %}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="/static/autosave.js"></script>
    <script src="/static/copyurl.js"></script>
{% endblock %}

{% block content %}
    <h2>FlashPaste 在线剪贴板</h2>
    {% if session.username %}
    <p>欢迎，{{ session.username }}！<a href="/logout">登出</a> | <a href="/myshares">我的分享</a></p>
    {% else %}
    <p><a href="/login">登录</a> | <a href="/register">注册</a></p>
    {% endif %}
    <form method="post" id="main-form">
        <div style="margin-bottom: 10px;">
            <label for="content-title" style="display: block; margin-bottom: 5px; font-weight: bold;">标题:</label>
            <input type="text" id="content-title" name="title" value="{{ title }}" placeholder="内容标题（可选）" style="width: 100%; max-width: 400px;">
        </div>
        <textarea id="content-textarea" name="content" rows="10" cols="50">{{ content }}</textarea><br>
        <button type="submit">保存</button>
        <span id="auto-save-status" style="margin-left: 10px; color: #666; font-size: 12px;"></span>
    </form>
    <form method="post" action="/share" id="share-form">
        <input type="hidden" id="share-content" name="content" value="{{ content }}">
        <input type="hidden" id="share-title" name="title" value="{{ title }}">
        <div style="margin-bottom: 10px;">
            <label><input type="checkbox" name="burn_after_reading" value="1"> 阅后即焚</label>
            <input type="text" name="password" placeholder="访问密码（可选）" style="margin-left: 10px;">
        </div>
        <div style="margin-bottom: 10px;">
            <select name="expire_hours" style="margin-right: 10px;">
                <option value="">永不过期</option>
                <option value="1">1小时后过期</option>
                <option value="24">1天后过期</option>
                <option value="168">1周后过期</option>
                <option value="720">1个月后过期</option>
            </select>
            <button type="submit">生成分享链接</button>
        </div>
    </form>
    
    {% if share_url %}
    <form>
        <h3 style="margin-top: 0; color: var(--text-color);">分享链接已生成：</h3>
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
            <input type="text" id="share-url-input" value="{{ share_url }}" readonly style="flex: 1; padding: 8px; border: 1px solid var(--input-border); border-radius: 4px; background: var(--form-bg); color: var(--text-color); font-size: 14px;">
            <button type="button" onclick="copyShareUrl()" style="background: var(--button-bg); color: var(--button-text); border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; white-space: nowrap;">复制链接</button>
        </div>
        <p><a href="{{ share_url }}" target="_blank" style="word-break: break-all; color: var(--link-color);">{{ share_url }}</a></p>
        <div id="copy-status" style="color: #27ae60; font-size: 12px; margin-top: 5px;"></div>
    </form>
    {% endif %}
{% endblock %}